<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PowerVR SDK</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
<table width="100%">
  <tr>
    <td width="33%">
      <p align="left">&nbsp;<a href="http://www.imgtec.com"><img border="0" src="IMGLogo.jpg" width="200" height="30"></a></p>
    </td>
    <td width="33%">
      <p align="center"><font color="#808080" face="Arial" size="2">PowerVR Software Development Kit</a></font></p>
    </td>
    <td width="34%">
      <p align="right"><a href="http://www.powervr.com"><img border="0" src="PVRlogo.jpg" width="200" height="27"></a></p>
    </td>
  </tr>
</table>
<hr>
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>PVRTMap.h</h1><a href="PVRTMap_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/******************************************************************************</span>
00002 <span class="comment"></span>
00003 <span class="comment"> @File         PVRTMap.h</span>
00004 <span class="comment"></span>
00005 <span class="comment"> @Title        PVRTArray</span>
00006 <span class="comment"></span>
00007 <span class="comment"> @Version       @Version      </span>
00008 <span class="comment"></span>
00009 <span class="comment"> @Copyright    Copyright (c) Imagination Technologies Limited.</span>
00010 <span class="comment"></span>
00011 <span class="comment"> @Platform     ANSI compatible</span>
00012 <span class="comment"></span>
00013 <span class="comment"> @Description  A simple and easy to use implementation of a map.</span>
00014 <span class="comment"></span>
00015 <span class="comment">******************************************************************************/</span>
00016 <span class="preprocessor">#ifndef __PVRTMAP_H__</span>
00017 <span class="preprocessor"></span><span class="preprocessor">#define __PVRTMAP_H__</span>
00018 <span class="preprocessor"></span>
00019 <span class="preprocessor">#include "<a class="code" href="PVRTArray_8h.html">PVRTArray.h</a>"</span>
00020 
00021 <span class="comment">/*!****************************************************************************</span>
00022 <span class="comment">Class</span>
00023 <span class="comment">******************************************************************************/</span>
00024 
00025 <span class="comment">/*!***************************************************************************</span>
00026 <span class="comment">* @Class        CPVRTMap</span>
00027 <span class="comment">* @Brief        Expanding map template class.</span>
00028 <span class="comment">* @Description  A simple and easy to use implementation of a map.</span>
00029 <span class="comment">*****************************************************************************/</span>
00030 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> KeyType, <span class="keyword">typename</span> DataType&gt;
00031 <span class="keyword">class </span><a class="code" href="classCPVRTMap.html">CPVRTMap</a>
<a name="l00032"></a><a class="code" href="classCPVRTMap.html">00032</a> {
00033 <span class="keyword">public</span>:
00034 
00035     <span class="comment">/*!***********************************************************************</span>
00036 <span class="comment">     @Function      CPVRTMap</span>
00037 <span class="comment">     @Return        A new CPVRTMap.</span>
00038 <span class="comment">     @Description   Constructor for a CPVRTMap.</span>
00039 <span class="comment">    *************************************************************************/</span>
00040     <a class="code" href="classCPVRTMap.html#a0">CPVRTMap</a>() : m_Keys(), m_Data(), m_uiSize(0)
00041     {}
<a name="l00042"></a><a class="code" href="classCPVRTMap.html#a0">00042</a> 
00043     <span class="comment">/*!***********************************************************************</span>
00044 <span class="comment">     @Function      ~CPVRTMap</span>
00045 <span class="comment">     @Description   Destructor for a CPVRTMap.</span>
00046 <span class="comment">    *************************************************************************/</span>
00047     <a class="code" href="classCPVRTMap.html#a1">~CPVRTMap</a>()
00048     {
00049         <span class="comment">//Clear the map, that's enough - the CPVRTArray members will tidy everything else up.</span>
<a name="l00050"></a><a class="code" href="classCPVRTMap.html#a1">00050</a>         <a class="code" href="classCPVRTMap.html#a8">Clear</a>();
00051     }
00052 
00053     <a class="code" href="PVRTError_8h.html#a5">EPVRTError</a> <a class="code" href="classCPVRTMap.html#a2">Reserve</a>(<span class="keyword">const</span> <a class="code" href="PVRTGlobal_8h.html#a22">PVRTuint32</a> uiSize)
00054     {
00055         <span class="comment">//Sets the capacity of each member array to the requested size. The array used will only expand.</span>
<a name="l00056"></a><a class="code" href="classCPVRTMap.html#a2">00056</a>         <span class="comment">//Returns the most serious error from either method.</span>
00057         <span class="keywordflow">return</span> <a class="code" href="PVRTGlobal_8h.html#a1">PVRT_MAX</a>(m_Keys.<a class="code" href="classCPVRTArray.html#a11">SetCapacity</a>(uiSize),m_Data.<a class="code" href="classCPVRTArray.html#a11">SetCapacity</a>(uiSize));
00058     }
00059 
00060     <span class="comment">/*!***********************************************************************</span>
00061 <span class="comment">     @Function      GetSize</span>
00062 <span class="comment">     @Return        Number of meaningful members in the map.</span>
00063 <span class="comment">     @Description   Returns the number of meaningful members in the map.</span>
00064 <span class="comment">    *************************************************************************/</span>
00065     <a class="code" href="PVRTGlobal_8h.html#a22">PVRTuint32</a> <a class="code" href="classCPVRTMap.html#a3">GetSize</a>()<span class="keyword"> const</span>
00066 <span class="keyword">    </span>{
00067         <span class="comment">//Return the size.</span>
00068         <span class="keywordflow">return</span> m_uiSize;
<a name="l00069"></a><a class="code" href="classCPVRTMap.html#a3">00069</a>     }
00070 
00071     <span class="comment">/*!***********************************************************************</span>
00072 <span class="comment">     @Function      GetIndexOf</span>
00073 <span class="comment">     @Input         key</span>
00074 <span class="comment">     @Return        The index value for a mapped item.</span>
00075 <span class="comment">     @Description   Gets the position of a particular key/data within the map.</span>
00076 <span class="comment">                    If the return value is exactly equal to the value of </span>
00077 <span class="comment">                    GetSize() then the item has not been found.</span>
00078 <span class="comment">    *************************************************************************/</span>
00079     <a class="code" href="PVRTGlobal_8h.html#a22">PVRTuint32</a> <a class="code" href="classCPVRTMap.html#a4">GetIndexOf</a>(<span class="keyword">const</span> KeyType key)<span class="keyword"> const</span>
00080 <span class="keyword">    </span>{
00081         <span class="comment">//Loop through all the valid keys.</span>
00082         <span class="keywordflow">for</span> (<a class="code" href="PVRTGlobal_8h.html#a22">PVRTuint32</a> i=0; i&lt;m_uiSize; ++i)
00083         {
<a name="l00084"></a><a class="code" href="classCPVRTMap.html#a4">00084</a>             <span class="comment">//Check if a key matches.</span>
00085             <span class="keywordflow">if</span> (m_Keys[i]==key)
00086             {
00087                 <span class="comment">//If a matched key is found, return the position.</span>
00088                 <span class="keywordflow">return</span> i;
00089             }
00090         }
00091 
00092         <span class="comment">//If not found, return the number of meaningful members.</span>
00093         <span class="keywordflow">return</span> m_uiSize;
00094     }
00095 
00096     <span class="comment">/*!***********************************************************************</span>
00097 <span class="comment">     @Function      GetDataAtIndex</span>
00098 <span class="comment">     @Input         uiIndex</span>
00099 <span class="comment">     @Return        Data type at the specified position.</span>
00100 <span class="comment">     @Description   Returns a pointer to the Data at a particular index. </span>
00101 <span class="comment">                    If the index supplied is not valid, NULL is returned </span>
00102 <span class="comment">                    instead. Deletion of data at this pointer will lead</span>
00103 <span class="comment">                    to undefined behaviour.</span>
00104 <span class="comment">    *************************************************************************/</span>
00105     <span class="keyword">const</span> DataType* <a class="code" href="classCPVRTMap.html#a5">GetDataAtIndex</a>(<span class="keyword">const</span> <a class="code" href="PVRTGlobal_8h.html#a22">PVRTuint32</a> uiIndex)<span class="keyword"> const</span>
00106 <span class="keyword">    </span>{
00107         <span class="keywordflow">return</span> &amp;(m_Data[uiIndex]);
00108     }
00109 
00110     <span class="comment">/*!***********************************************************************</span>
<a name="l00111"></a><a class="code" href="classCPVRTMap.html#a5">00111</a> <span class="comment">     @Function      operator[]</span>
00112 <span class="comment">     @Input         key</span>
00113 <span class="comment">     @Return        Data that is mapped to 'key'.</span>
00114 <span class="comment">     @Description   If a mapping already exists for 'key' then it will return </span>
00115 <span class="comment">                    the associated data. If no mapping currently exists, a new </span>
00116 <span class="comment">                    element is created in place.</span>
00117 <span class="comment">    *************************************************************************/</span>
00118     DataType&amp; <a class="code" href="classCPVRTMap.html#a6">operator[] </a>(<span class="keyword">const</span> KeyType key)
00119     {
00120         <span class="comment">//Get the index of the key.</span>
00121         <a class="code" href="PVRTGlobal_8h.html#a22">PVRTuint32</a> uiIndex = <a class="code" href="classCPVRTMap.html#a4">GetIndexOf</a>(key);
00122 
00123         <span class="comment">//Check the index is valid</span>
00124         <span class="keywordflow">if</span> (uiIndex != m_uiSize)
<a name="l00125"></a><a class="code" href="classCPVRTMap.html#a6">00125</a>         {
00126             <span class="comment">//Return mapped data if the index is valid.</span>
00127             <span class="keywordflow">return</span> m_Data[uiIndex];
00128         }
00129         <span class="keywordflow">else</span>
00130         {
00131             <span class="comment">//Append the key to the Keys array.</span>
00132             m_Keys.<a class="code" href="classCPVRTArray.html#a7">Append</a>(key);
00133 
00134             <span class="comment">//Create a new DataType.</span>
00135             DataType sNewData;
00136 
00137             <span class="comment">//Append the new pointer to the Data array.</span>
00138             m_Data.<a class="code" href="classCPVRTArray.html#a7">Append</a>(sNewData);
00139 
00140             <span class="comment">//Increment the size of meaningful data.</span>
00141             ++m_uiSize;
00142 
00143             <span class="comment">//Return the contents of pNewData.</span>
00144             <span class="keywordflow">return</span> m_Data[m_Keys.<a class="code" href="classCPVRTArray.html#a17">GetSize</a>()-1];
00145         }
00146     }
00147 
00148     <span class="comment">/*!***********************************************************************</span>
00149 <span class="comment">     @Function      Remove</span>
00150 <span class="comment">     @Input         key</span>
00151 <span class="comment">     @Return        Returns PVR_FAIL if item doesn't exist. </span>
00152 <span class="comment">                    Otherwise returns PVR_SUCCESS.</span>
00153 <span class="comment">     @Description   Removes an element from the map if it exists.</span>
00154 <span class="comment">    *************************************************************************/</span>
00155     <a class="code" href="PVRTError_8h.html#a5">EPVRTError</a> <a class="code" href="classCPVRTMap.html#a7">Remove</a>(<span class="keyword">const</span> KeyType key)
00156     {
00157         <span class="comment">//Finds the index of the key.</span>
00158         <a class="code" href="PVRTGlobal_8h.html#a22">PVRTuint32</a> uiIndex=<a class="code" href="classCPVRTMap.html#a4">GetIndexOf</a>(key);
00159 
00160         <span class="comment">//If the key is invalid, fail.</span>
00161         <span class="keywordflow">if</span> (uiIndex==m_uiSize)
00162         {
<a name="l00163"></a><a class="code" href="classCPVRTMap.html#a7">00163</a>             <span class="comment">//Return failure.</span>
00164             <span class="keywordflow">return</span> <a class="code" href="PVRTError_8h.html#a5a2">PVR_FAIL</a>;
00165         }
00166         
00167         <span class="comment">//Decrement the size of the map to ignore the last element in each array.</span>
00168         m_uiSize--;
00169 
00170         <span class="comment">//Copy the last key over the deleted key. There are now two copies of one element, </span>
00171         <span class="comment">//but the one at the end of the array is ignored.</span>
00172         m_Keys[uiIndex]=m_Keys[m_uiSize-1];
00173 
00174         <span class="comment">//Copy the last data over the deleted data in the same way as the keys.</span>
00175         m_Data[uiIndex]=m_Data[m_uiSize-1];
00176 
00177         <span class="comment">//Return success.</span>
00178         <span class="keywordflow">return</span> <a class="code" href="PVRTError_8h.html#a5a1">PVR_SUCCESS</a>;
00179     }
00180 
00181     <span class="comment">/*!***********************************************************************</span>
00182 <span class="comment">     @Function      Clear</span>
00183 <span class="comment">     @Description   Clears the Map of all data values.</span>
00184 <span class="comment">    *************************************************************************/</span>
00185     <span class="keywordtype">void</span> <a class="code" href="classCPVRTMap.html#a8">Clear</a>()
00186     {
00187         <span class="comment">//Set the size to 0.</span>
00188         m_uiSize=0;
00189         m_Keys.<a class="code" href="classCPVRTArray.html#a9">Clear</a>();
00190         m_Data.<a class="code" href="classCPVRTArray.html#a9">Clear</a>();
00191     }
00192 
00193     <span class="comment">/*!***********************************************************************</span>
<a name="l00194"></a><a class="code" href="classCPVRTMap.html#a8">00194</a> <span class="comment">     @Function      Exists</span>
00195 <span class="comment">     @Input         key</span>
00196 <span class="comment">     @Return        Whether data exists for the specified key or not.</span>
00197 <span class="comment">     @Description   Checks whether or not data exists for the specified key.</span>
00198 <span class="comment">    *************************************************************************/</span>
00199     <span class="keywordtype">bool</span> <a class="code" href="classCPVRTMap.html#a9">Exists</a>(<span class="keyword">const</span> KeyType key)<span class="keyword"> const</span>
00200 <span class="keyword">    </span>{
00201         <span class="comment">//Checks for a valid index for key, if not, returns false.</span>
00202         <span class="keywordflow">return</span> (<a class="code" href="classCPVRTMap.html#a4">GetIndexOf</a>(key) != m_uiSize);
00203     }
00204 
00205 <span class="keyword">private</span>:
00206 
00207     <span class="comment">//Array of all the keys. Indices match m_Data.</span>
00208     <a class="code" href="classCPVRTArray.html">CPVRTArray&lt;KeyType&gt;</a> m_Keys;
<a name="l00209"></a><a class="code" href="classCPVRTMap.html#a9">00209</a> 
00210     <span class="comment">//Array of pointers to all the allocated data.</span>
00211     <a class="code" href="classCPVRTArray.html">CPVRTArray&lt;DataType&gt;</a> m_Data;
00212 
00213     <span class="comment">//The number of meaningful members in the map.</span>
00214     <a class="code" href="PVRTGlobal_8h.html#a22">PVRTuint32</a> m_uiSize;
00215 };
00216 
00217 <span class="preprocessor">#endif // __PVRTMAP_H__</span>
00218 <span class="preprocessor"></span>
00219 <span class="comment">/*****************************************************************************</span>
00220 <span class="comment">End of file (PVRTMap.h)</span>
00221 <span class="comment">*****************************************************************************/</span>
00222 
00223 
</pre></div><br>
<br>
<P align=left><FONT size=2><STRONG><A 
   href="http://www.imgtec.com/powervr/insider/legal/index.asp">Copyright</A> © 
   1999-2008, Imagination Technologies Ltd.</STRONG></FONT></P>
<hr>
<address style="align: left;"><small><FONT color=f0f>
Generated by <a href="http://www.doxygen.org/index.html">DOXYGEN</a> 1.3.6</small></address>
</body>
</html>

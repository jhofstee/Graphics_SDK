<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PowerVR SDK</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
<table width="100%">
  <tr>
    <td width="33%">
      <p align="left">&nbsp;<a href="http://www.imgtec.com"><img border="0" src="IMGLogo.jpg" width="200" height="30"></a></p>
    </td>
    <td width="33%">
      <p align="center"><font color="#808080" face="Arial" size="2">PowerVR Software Development Kit</a></font></p>
    </td>
    <td width="34%">
      <p align="right"><a href="http://www.powervr.com"><img border="0" src="PVRlogo.jpg" width="200" height="27"></a></p>
    </td>
  </tr>
</table>
<hr>
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>PVRTSkipGraph.h</h1><a href="PVRTSkipGraph_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/******************************************************************************</span>
00002 <span class="comment"></span>
00003 <span class="comment"> @File         PVRTSkipGraph.h</span>
00004 <span class="comment"></span>
00005 <span class="comment"> @Title        PVRTSkipGraph</span>
00006 <span class="comment"></span>
00007 <span class="comment"> @Version       @Version      </span>
00008 <span class="comment"></span>
00009 <span class="comment"> @Copyright    Copyright (c) Imagination Technologies Limited.</span>
00010 <span class="comment"></span>
00011 <span class="comment"> @Platform     ANSI compatible</span>
00012 <span class="comment"></span>
00013 <span class="comment"> @Description  A "tree-like" structure for storing data which, unlike a tree, can</span>
00014 <span class="comment">               reference any other node.</span>
00015 <span class="comment"></span>
00016 <span class="comment">******************************************************************************/</span>
00017 <span class="preprocessor">#ifndef __PVRTSKIPGRAPH_H__</span>
00018 <span class="preprocessor"></span><span class="preprocessor">#define __PVRTSKIPGRAPH_H__</span>
00019 <span class="preprocessor"></span>
00020 
00021 <span class="preprocessor">#include "<a class="code" href="PVRTArray_8h.html">PVRTArray.h</a>"</span>
00022 <span class="preprocessor">#include "<a class="code" href="PVRTHash_8h.html">PVRTHash.h</a>"</span>
00023 
00024 <span class="comment">/*!***************************************************************************</span>
00025 <span class="comment"> @Class             CPVRTSkipGraphNode</span>
00026 <span class="comment"> @Description       Stores a pointer to the node's data and also uses a dynamic</span>
00027 <span class="comment">                    array to store pointer to nodes this node depends on and</span>
00028 <span class="comment">                    another to store pointers to nodes that are dependant on this node</span>
00029 <span class="comment">*****************************************************************************/</span>
00030 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
00031 <span class="keyword">class </span><a class="code" href="classCPVRTSkipGraphNode.html">CPVRTSkipGraphNode</a>
<a name="l00032"></a><a class="code" href="classCPVRTSkipGraphNode.html">00032</a> {
00033 <span class="keyword">private</span>:
00034     T                               m_pData;
00035     <a class="code" href="classCPVRTArray.html">CPVRTArray&lt;CPVRTSkipGraphNode*&gt;</a> m_apDependencies;   <span class="comment">// What I depend on</span>
00036     <a class="code" href="classCPVRTArray.html">CPVRTArray&lt;CPVRTSkipGraphNode*&gt;</a> m_apDependents;     <span class="comment">// What depends on me</span>
00037     
00038 <span class="keyword">public</span>:
00039     <span class="comment">/*!***************************************************************************</span>
00040 <span class="comment">    @Function       CPVRTSkipGraphNode</span>
00041 <span class="comment">    @Description    Constructor</span>
00042 <span class="comment">    *****************************************************************************/</span>
00043     <a class="code" href="classCPVRTSkipGraphNode.html#a0">CPVRTSkipGraphNode</a>()
00044     {}
<a name="l00045"></a><a class="code" href="classCPVRTSkipGraphNode.html#a0">00045</a> 
00046     <span class="comment">/*!***************************************************************************</span>
00047 <span class="comment">    @Function       CPVRTSkipGraphNode</span>
00048 <span class="comment">    @Input          data</span>
00049 <span class="comment">    @Description    Overloaded constructor</span>
00050 <span class="comment">    *****************************************************************************/</span>
00051     <a class="code" href="classCPVRTSkipGraphNode.html#a0">CPVRTSkipGraphNode</a>(<span class="keyword">const</span> T&amp; data) : m_pData(data)
00052     {}
00053 
<a name="l00054"></a><a class="code" href="classCPVRTSkipGraphNode.html#a1">00054</a>     <span class="comment">/*!***************************************************************************</span>
00055 <span class="comment">    @Function       ~CPVRTSkipGraphNode</span>
00056 <span class="comment">    @Description    Destructor</span>
00057 <span class="comment">    *****************************************************************************/</span>
00058     <a class="code" href="classCPVRTSkipGraphNode.html#a2">~CPVRTSkipGraphNode</a>()
00059     {} 
00060 
00061     <span class="comment">/*!***************************************************************************</span>
<a name="l00062"></a><a class="code" href="classCPVRTSkipGraphNode.html#a2">00062</a> <span class="comment">    @Function       GetNumDependencies</span>
00063 <span class="comment">    @Return         unsigned int    </span>
00064 <span class="comment">    @Description    Returns the number of dependencies referenced by this node.</span>
00065 <span class="comment">    *****************************************************************************/</span>
00066     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classCPVRTSkipGraphNode.html#a3">GetNumDependencies</a>()<span class="keyword"> const                 </span>
00067 <span class="keyword">    </span>{ 
00068         <span class="keywordflow">return</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)m_apDependencies.<a class="code" href="classCPVRTArray.html#a17">GetSize</a>(); 
00069     }
00070 
<a name="l00071"></a><a class="code" href="classCPVRTSkipGraphNode.html#a3">00071</a>     <span class="comment">/*!***************************************************************************</span>
00072 <span class="comment">    @Function       GetDependency</span>
00073 <span class="comment">    @Input          ui32Id</span>
00074 <span class="comment">    @Return         CPVRTSkipGraphNode &amp;    </span>
00075 <span class="comment">    @Description    Returns given dependency.</span>
00076 <span class="comment">    *****************************************************************************/</span>
00077     <a class="code" href="classCPVRTSkipGraphNode.html">CPVRTSkipGraphNode</a>&amp; <a class="code" href="classCPVRTSkipGraphNode.html#a4">GetDependency</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ui32Id)<span class="keyword"> const</span>
00078 <span class="keyword">    </span>{ 
00079         <a class="code" href="PVRTGlobal_8h.html#a10">_ASSERT</a>(ui32Id &gt;= 0 &amp;&amp; ui32Id &lt; (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)m_apDependencies.<a class="code" href="classCPVRTArray.html#a17">GetSize</a>());
00080         <span class="keywordflow">return</span> *m_apDependencies[ui32Id];
00081     }
00082 
<a name="l00083"></a><a class="code" href="classCPVRTSkipGraphNode.html#a4">00083</a> 
00084     <span class="comment">/*!***************************************************************************</span>
00085 <span class="comment">    @Function       AddDependency</span>
00086 <span class="comment">    @Output         pDependentNode</span>
00087 <span class="comment">    @Return         bool    </span>
00088 <span class="comment">    @Description    Adds a dependency to this node.</span>
00089 <span class="comment">    *****************************************************************************/</span>
00090     <span class="keywordtype">bool</span> <a class="code" href="classCPVRTSkipGraphNode.html#a5">AddDependency</a>(<a class="code" href="classCPVRTSkipGraphNode.html">CPVRTSkipGraphNode</a>* pDependentNode)
00091     {
00092         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ui(0);
00093 
00094         <span class="keywordflow">if</span>(pDependentNode == <span class="keyword">this</span>)
00095             <span class="keywordflow">return</span> <span class="keyword">false</span>;
00096 
<a name="l00097"></a><a class="code" href="classCPVRTSkipGraphNode.html#a5">00097</a>         <span class="keywordflow">if</span>(!pDependentNode)
00098             <span class="keywordflow">return</span> <span class="keyword">false</span>;
00099 
00100         <span class="comment">/*</span>
00101 <span class="comment">            Check the dependency doesn't already exist</span>
00102 <span class="comment">        */</span>
00103         <span class="keywordflow">for</span>(ui = 0; ui &lt; (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)m_apDependencies.<a class="code" href="classCPVRTArray.html#a17">GetSize</a>(); ++ui)
00104         {
00105             <span class="keywordflow">if</span>(m_apDependencies[ui] == pDependentNode)
00106             {
00107                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
00108             }
00109         }
00110 
00111         <span class="comment">/*</span>
00112 <span class="comment">            Add the dependency and also set this node as a dependent of</span>
00113 <span class="comment">            the referenced node</span>
00114 <span class="comment">        */</span>
00115         m_apDependencies.<a class="code" href="classCPVRTArray.html#a7">Append</a>(pDependentNode);
00116         pDependentNode-&gt;<a class="code" href="classCPVRTSkipGraphNode.html#d0">AddDependent</a>(<span class="keyword">this</span>);
00117         
00118         <span class="keywordflow">return</span> <span class="keyword">true</span>;
00119     }
00120 
00121     <span class="comment">/*!***************************************************************************</span>
00122 <span class="comment">    @Function       GetData</span>
00123 <span class="comment">    @Return         T &amp; </span>
00124 <span class="comment">    @Description    Returns the data associated with this node.</span>
00125 <span class="comment">    *****************************************************************************/</span>
00126     T&amp; <a class="code" href="classCPVRTSkipGraphNode.html#a6">GetData</a>()                
00127     {
00128         <span class="keywordflow">return</span> m_pData;
00129     }
00130 
00131 <span class="keyword">private</span>:
00132     <span class="comment">/*!***************************************************************************</span>
00133 <span class="comment">    @Function       AddDependent</span>
<a name="l00134"></a><a class="code" href="classCPVRTSkipGraphNode.html#a6">00134</a> <span class="comment">    @Output         pDependancyNode</span>
00135 <span class="comment">    @Return         bool    </span>
00136 <span class="comment">    @Description    Adds a dependent to this node.</span>
00137 <span class="comment">    *****************************************************************************/</span>
00138     <span class="keywordtype">bool</span> AddDependent(<a class="code" href="classCPVRTSkipGraphNode.html">CPVRTSkipGraphNode</a>* pDependencyNode)
00139     {
00140         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ui(0);
00141 
00142         <span class="keywordflow">if</span>(!pDependencyNode)
00143             <span class="keywordflow">return</span> <span class="keyword">false</span>;
00144 
00145         <span class="comment">/*</span>
00146 <span class="comment">            Check the dependency doesn't already exist</span>
00147 <span class="comment">        */</span>
00148         <span class="keywordflow">for</span>(ui = 0; ui &lt; (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)m_apDependents.<a class="code" href="classCPVRTArray.html#a17">GetSize</a>(); ++ui)
00149         {
00150             <span class="keywordflow">if</span>(m_apDependencies[ui] == pDependencyNode)
00151             {
00152                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
00153             }
00154         }
00155 
00156         <span class="comment">/*</span>
00157 <span class="comment">            Add the dependancy</span>
00158 <span class="comment">        */</span>
00159         m_apDependents.<a class="code" href="classCPVRTArray.html#a7">Append</a>(pDependencyNode);
00160         <span class="keywordflow">return</span> <span class="keyword">true</span>;
00161     }
00162 };
00163 
00164 <span class="comment">/*!***************************************************************************</span>
00165 <span class="comment"> @Class             CPVRTSkipGraphRoot</span>
00166 <span class="comment"> @Description       This class is the entry point for creating and accessing</span>
00167 <span class="comment">                    the elements of a skip graph. It uses a hash table to store</span>
00168 <span class="comment">                    the nodes of the structure and a hash value that allows</span>
00169 <span class="comment">                    fast searching of the skip graph</span>
00170 <span class="comment">*****************************************************************************/</span>
00171 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
00172 <span class="keyword">class </span><a class="code" href="classCPVRTSkipGraphRoot.html">CPVRTSkipGraphRoot</a>
00173 {
00174 <span class="comment">//-------------------------------------------------------------------------//</span>
00175 <span class="keyword">private</span>:
00176 
00177     <span class="comment">/*!***************************************************************************</span>
00178 <span class="comment">     @Struct            SPVRTHashElement</span>
00179 <span class="comment">     @Description       A struct to store data and a hash value generated from the</span>
00180 <span class="comment">                        data. The hash value allows faster searching of the skip</span>
00181 <span class="comment">                        graph</span>
<a name="l00182"></a><a class="code" href="classCPVRTSkipGraphRoot.html">00182</a> <span class="comment">    *****************************************************************************/</span>
00183     <span class="keyword">struct </span>SPVRTHashElement
00184     {       
00185     <span class="keyword">public</span>:
00186         <span class="comment">/*!***************************************************************************</span>
00187 <span class="comment">        @Function       SPVRTHashElement</span>
00188 <span class="comment">        @Input          hash</span>
00189 <span class="comment">        @Input          data</span>
00190 <span class="comment">        @Description    Overloaded constructor.</span>
00191 <span class="comment">        *****************************************************************************/</span>
00192         SPVRTHashElement(<span class="keyword">const</span> <a class="code" href="classCPVRTHash.html">CPVRTHash</a>&amp; hash, <span class="keyword">const</span> T&amp; data)
00193         :
00194         m_hash(hash),
00195         m_skipGraphNode(data)
00196         {}
00197 
00198         <span class="comment">/*!***************************************************************************</span>
00199 <span class="comment">        @Function       SPVRTHashElement</span>
00200 <span class="comment">        @Description    Constructor</span>
00201 <span class="comment">        *****************************************************************************/</span>
00202         SPVRTHashElement()
00203         {}
00204 
00205         <span class="comment">/*!***************************************************************************</span>
00206 <span class="comment">        @Function       ~SPVRTHashElement</span>
00207 <span class="comment">        @Description    Destructor</span>
00208 <span class="comment">        *****************************************************************************/</span>
00209         ~SPVRTHashElement()
00210         {}
00211         
00212         <span class="comment">/*!***************************************************************************</span>
00213 <span class="comment">        @Function       GetHash</span>
00214 <span class="comment">        @Return         unsigned int    </span>
00215 <span class="comment">        @Description    Returns the element's hash value.</span>
00216 <span class="comment">        *****************************************************************************/</span>
00217         <span class="keyword">const</span> <a class="code" href="classCPVRTHash.html">CPVRTHash</a>&amp; GetHash()<span class="keyword"> const                </span>
00218 <span class="keyword">        </span>{ 
00219             <span class="keywordflow">return</span> m_hash;
00220         }
00221 
00222         <span class="comment">/*!***************************************************************************</span>
00223 <span class="comment">        @Function       GetNode</span>
00224 <span class="comment">        @Return         CPVRTSkipGraphNode&lt;T&gt;&amp;  </span>
00225 <span class="comment">        @Description    Return the node associated with this element.</span>
00226 <span class="comment">        *****************************************************************************/</span>
00227         <a class="code" href="classCPVRTSkipGraphNode.html">CPVRTSkipGraphNode&lt;T&gt;</a>&amp; GetNode()            
00228         {
00229             <span class="keywordflow">return</span> m_skipGraphNode; 
00230         }
00231 
00232         <span class="comment">/*!***************************************************************************</span>
00233 <span class="comment">        @Function       GetNode</span>
00234 <span class="comment">        @Return         CPVRTSkipGraphNode&lt;T&gt;&amp;  </span>
00235 <span class="comment">        @Description    Return the node associated with this element.</span>
00236 <span class="comment">        *****************************************************************************/</span>
00237         <span class="keyword">const</span> <a class="code" href="classCPVRTSkipGraphNode.html">CPVRTSkipGraphNode&lt;T&gt;</a>&amp; GetNode()<span class="keyword"> const            </span>
00238 <span class="keyword">        </span>{
00239             <span class="keywordflow">return</span> m_skipGraphNode; 
00240         }
00241 
00242     <span class="keyword">private</span>:
00243         <a class="code" href="classCPVRTHash.html">CPVRTHash</a>               m_hash;
00244         <a class="code" href="classCPVRTSkipGraphNode.html">CPVRTSkipGraphNode&lt;T&gt;</a>   m_skipGraphNode;
00245     };
00246 
00247     
00248     <a class="code" href="classCPVRTArray.html">CPVRTArray&lt;SPVRTHashElement&gt;</a>        m_aHashTable;
00249 
00250 <span class="comment">//-------------------------------------------------------------------------//</span>
00251 <span class="keyword">public</span>:
00252 
00253     <span class="comment">/*!***************************************************************************</span>
00254 <span class="comment">     @Function          AddNode</span>
00255 <span class="comment">     @Input             data                            The data of the node to be added</span>
00256 <span class="comment">     @Return            CPVRTSkipGraphNode&lt;T&gt;* const    A handle to the added node</span>
00257 <span class="comment">     @Description       Searches through the hash table to see if the added node already</span>
00258 <span class="comment">                        exists. If it doesn't, it creates a node.</span>
00259 <span class="comment">                        The function returns true if the node was found or was created</span>
00260 <span class="comment">                        successfully.</span>
00261 <span class="comment">    *****************************************************************************/</span>
00262     <span class="keywordtype">bool</span> <a class="code" href="classCPVRTSkipGraphRoot.html#a0">AddNode</a>(<span class="keyword">const</span> T&amp; data)
00263     {
00264         <a class="code" href="classCPVRTHash.html">CPVRTHash</a> NewNodeHash((<span class="keywordtype">void</span>*)&amp;data, <span class="keyword">sizeof</span>(T), 1);
00265         <span class="keywordtype">int</span> iArrayElement(-1);
00266         <span class="comment">/*</span>
00267 <span class="comment">            First, search the hash table to see</span>
00268 <span class="comment">            if the node already exists</span>
00269 <span class="comment">        */</span>
00270         <a class="code" href="classCPVRTSkipGraphNode.html">CPVRTSkipGraphNode&lt;T&gt;</a>* skipGraphNode(FindNode(NewNodeHash));
00271 
00272         <span class="keywordflow">if</span>(skipGraphNode == NULL)
00273         {
00274             <span class="comment">/*</span>
00275 <span class="comment">                The node wasn't found, so a new node needs to be</span>
00276 <span class="comment">                created</span>
00277 <span class="comment">            */</span>
00278             iArrayElement = m_aHashTable.<a class="code" href="classCPVRTArray.html#a7">Append</a>(SPVRTHashElement(NewNodeHash, data));
00279 
<a name="l00280"></a><a class="code" href="classCPVRTSkipGraphRoot.html#a0">00280</a>             <span class="comment">/*</span>
00281 <span class="comment">                Now point to the new instance</span>
00282 <span class="comment">            */</span>
00283             skipGraphNode = &amp;m_aHashTable[iArrayElement].GetNode();
00284         }
00285 
00286         <span class="keywordflow">return</span> skipGraphNode ? <span class="keyword">true</span> : <span class="keyword">false</span>;
00287     }
00288 
00289 
00290     <span class="comment">/*!***************************************************************************</span>
00291 <span class="comment">    @Function       AddNodeDependancy</span>
00292 <span class="comment">    @Input          nodeData</span>
00293 <span class="comment">    @Input          dependantData</span>
00294 <span class="comment">    @Return         bool    </span>
00295 <span class="comment">    @Description    Adds a node dependency.</span>
00296 <span class="comment">    *****************************************************************************/</span>
00297     <span class="keywordtype">bool</span> <a class="code" href="classCPVRTSkipGraphRoot.html#a1">AddNodeDependency</a>(<span class="keyword">const</span> T&amp; nodeData, <span class="keyword">const</span> T&amp; dependantData)
00298     {
00299         <a class="code" href="classCPVRTSkipGraphNode.html">CPVRTSkipGraphNode&lt;T&gt;</a>* pNode(NULL);
00300         <a class="code" href="classCPVRTSkipGraphNode.html">CPVRTSkipGraphNode&lt;T&gt;</a>* pDependantNode(NULL);
00301 
00302         pNode = FindNode(nodeData);
00303         <span class="keywordflow">if</span>(!pNode)
00304         {
00305             <span class="keywordflow">return</span> <span class="keyword">false</span>;
00306         }
00307 
00308         pDependantNode = FindNode(dependantData);
00309         <span class="keywordflow">if</span>(!pDependantNode)
00310         {
00311             <span class="keywordflow">return</span> <span class="keyword">false</span>;
00312         }
00313 
00314         <span class="comment">/*</span>
00315 <span class="comment">            Nodes are not allowed to self reference</span>
<a name="l00316"></a><a class="code" href="classCPVRTSkipGraphRoot.html#a1">00316</a> <span class="comment">        */</span>
00317         <span class="keywordflow">if</span>(pNode == pDependantNode)
00318         {
00319             <span class="keywordflow">return</span> <span class="keyword">false</span>;
00320         }
00321         pNode-&gt;<a class="code" href="classCPVRTSkipGraphNode.html#a5">AddDependency</a>(pDependantNode);
00322 
00323         <span class="keywordflow">return</span> <span class="keyword">true</span>;
00324     }
00325 
00326     <span class="comment">/*!***************************************************************************</span>
00327 <span class="comment">     @Function          GetNumNodes</span>
00328 <span class="comment">     @Return            unsigned int                    The total number of nodes</span>
00329 <span class="comment">     @Description       Returns the total number of nodes in the skip graph.</span>
00330 <span class="comment">    *****************************************************************************/</span>
00331     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classCPVRTSkipGraphRoot.html#a2">GetNumNodes</a>()<span class="keyword"> const</span>
00332 <span class="keyword">    </span>{
00333         <span class="keywordflow">return</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)m_aHashTable.<a class="code" href="classCPVRTArray.html#a17">GetSize</a>();
00334     }
00335 
00336     <span class="comment">/*!***************************************************************************</span>
00337 <span class="comment">     @Function          RetreiveSortedDependancyList</span>
00338 <span class="comment">     @Input             aOutputArray                    The dynamic array to store</span>
00339 <span class="comment">                                                        the sorted results in</span>
00340 <span class="comment">     @Input             ui32NodeID                      The ID of the root node for</span>
00341 <span class="comment">                                                        the dependency search</span>
00342 <span class="comment">     @Description       Returns a sorted list of dependencies for the specified</span>
00343 <span class="comment">                        node. The list is ordered with the leaf nodes at the front,</span>
00344 <span class="comment">                        followed by nodes that depend on them and so forth until</span>
00345 <span class="comment">                        the root node is reached and added at the end of the list</span>
00346 <span class="comment">    *****************************************************************************/</span>
00347     <span class="keywordtype">void</span> <a class="code" href="classCPVRTSkipGraphRoot.html#a3">RetreiveSortedDependencyList</a>(<a class="code" href="classCPVRTArray.html">CPVRTArray&lt;T&gt;</a> &amp;aOutputArray, 
00348                                         <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ui32NodeID)
00349     {
00350         <a class="code" href="PVRTGlobal_8h.html#a10">_ASSERT</a>(ui32NodeID &gt;= 0 &amp;&amp; ui32NodeID &lt; (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)m_aHashTable.<a class="code" href="classCPVRTArray.html#a17">GetSize</a>());
<a name="l00351"></a><a class="code" href="classCPVRTSkipGraphRoot.html#a2">00351</a>         RecursiveSortedListAdd(aOutputArray, m_aHashTable[ui32NodeID].GetNode());
00352     }
00353 
00354     <span class="comment">/*!***************************************************************************</span>
00355 <span class="comment">     @Function          operator[]</span>
00356 <span class="comment">     @Return            T&amp;                              Handle to the node data</span>
00357 <span class="comment">     @Description       Overloads operator[] to returns a handle to the node data</span>
00358 <span class="comment">                        for the specified ID</span>
00359 <span class="comment">    *****************************************************************************/</span>
00360     T&amp; <a class="code" href="classCPVRTSkipGraphRoot.html#a4">operator[]</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ui32NodeID)
00361     {
00362         <span class="keywordflow">return</span> *(GetNodeData(ui32NodeID));
00363     }
00364     
00365     <span class="comment">/*!***************************************************************************</span>
00366 <span class="comment">     @Function          operator[]</span>
00367 <span class="comment">     @Return            T&amp;                              Handle to the node data</span>
<a name="l00368"></a><a class="code" href="classCPVRTSkipGraphRoot.html#a3">00368</a> <span class="comment">     @Description       Overloads operator[] to returns a const handle to the node </span>
00369 <span class="comment">                        data for the specified ID</span>
00370 <span class="comment">    *****************************************************************************/</span>
00371     <span class="keyword">const</span> T&amp; <a class="code" href="classCPVRTSkipGraphRoot.html#a4">operator[]</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ui32NodeID)<span class="keyword"> const</span>
00372 <span class="keyword">    </span>{
00373         <span class="keywordflow">return</span> *(GetNodeData(ui32NodeID));
00374     }
00375 
00376 <span class="comment">//-------------------------------------------------------------------------//</span>
00377 <span class="keyword">private</span>:
00378     <span class="comment">/*!***************************************************************************</span>
00379 <span class="comment">     @Function          RetreiveSortedDependancyList</span>
00380 <span class="comment">     @Input             aOutputArray                    The dynamic array to store</span>
00381 <span class="comment">                                                        the sorted results in</span>
<a name="l00382"></a><a class="code" href="classCPVRTSkipGraphRoot.html#a4">00382</a> <span class="comment">     @Input             currentNode                     The current node to process</span>
00383 <span class="comment">     @Description       Recursively adds node dependancies to aOutputArray.</span>
00384 <span class="comment">                        By doing so, aOutputArray will be ordered from leaf nodes to</span>
00385 <span class="comment">                        the root node that started the recursive chain</span>
00386 <span class="comment">    *****************************************************************************/</span>
00387     <span class="keywordtype">void</span> RecursiveSortedListAdd(<a class="code" href="classCPVRTArray.html">CPVRTArray&lt;T&gt;</a> &amp;aOutputArray,
00388                                 <a class="code" href="classCPVRTSkipGraphNode.html">CPVRTSkipGraphNode&lt;T&gt;</a> &amp;currentNode)
00389     {
00390         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ui(0);
00391 
00392         <span class="comment">/*</span>
00393 <span class="comment">            Recursively add dependancies first</span>
<a name="l00394"></a><a class="code" href="classCPVRTSkipGraphRoot.html#a5">00394</a> <span class="comment">        */</span>
00395         <span class="keywordflow">for</span>(ui = 0; ui &lt; currentNode.<a class="code" href="classCPVRTSkipGraphNode.html#a3">GetNumDependencies</a>(); ++ui)
00396         {
00397             RecursiveSortedListAdd(aOutputArray, currentNode.<a class="code" href="classCPVRTSkipGraphNode.html#a4">GetDependency</a>(ui));
00398         }
00399 
00400         <span class="comment">/*</span>
00401 <span class="comment">            Then add this node to the array</span>
00402 <span class="comment">        */</span>
00403         aOutputArray.<a class="code" href="classCPVRTArray.html#a7">Append</a>(currentNode.<a class="code" href="classCPVRTSkipGraphNode.html#a6">GetData</a>());
00404     }
00405 
00406     <span class="comment">/*!***************************************************************************</span>
00407 <span class="comment">     @Function          GetNodeData</span>
00408 <span class="comment">     @Input/Output      ui32NodeID                      The node's ID</span>
00409 <span class="comment">     @Return            T*                              A handle to node's data</span>
00410 <span class="comment">     @Description       Retrieve a handle to the specified node's data</span>
00411 <span class="comment">    *****************************************************************************/</span>
00412     T* GetNodeData(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ui32NodeID)
00413     {
00414         <a class="code" href="PVRTGlobal_8h.html#a10">_ASSERT</a>(ui32NodeID &gt;= 0 &amp;&amp; ui32NodeID &lt; (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)m_aHashTable.<a class="code" href="classCPVRTArray.html#a17">GetSize</a>());
00415         <span class="keywordflow">return</span> &amp;m_aHashTable[ui32NodeID].GetNode().GetData();
00416     }
00417     
00418     <span class="comment">/*!***************************************************************************</span>
00419 <span class="comment">     @Function          FindNode</span>
00420 <span class="comment">     @Input/Output      ui32Hash                        The hash value to search with</span>
00421 <span class="comment">     @Return            CPVRTSkipGraphNode&lt;T&gt;* const    A handle to the found node</span>
00422 <span class="comment">     @Description       Use the input hash to search the hash table and see if the</span>
00423 <span class="comment">                        node already exists. If it does, the function returns a pointer</span>
00424 <span class="comment">                        to the node. If it doesn't, it returns NULL</span>
00425 <span class="comment">    *****************************************************************************/</span>
00426     <a class="code" href="classCPVRTSkipGraphNode.html">CPVRTSkipGraphNode&lt;T&gt;</a>* FindNode(<span class="keyword">const</span> <a class="code" href="classCPVRTHash.html">CPVRTHash</a>&amp; Hash)
00427     {
00428         <span class="keywordtype">int</span> i(0);
00429         <span class="keywordtype">int</span> i32HashTableSize(m_aHashTable.<a class="code" href="classCPVRTArray.html#a17">GetSize</a>());
00430 
00431         <span class="comment">/*</span>
00432 <span class="comment">            A NULL hash means the node has not initialised</span>
00433 <span class="comment">            correctly</span>
00434 <span class="comment">        */</span>
00435         <span class="keywordflow">if</span>(Hash == 0)
00436             <span class="keywordflow">return</span> NULL;
00437 
00438         <span class="comment">/*</span>
00439 <span class="comment">            NOTE:</span>
00440 <span class="comment">            In the future, the hash table could be sorted from</span>
00441 <span class="comment">            lowest hash value to highest so that binary search could</span>
00442 <span class="comment">            be used to find a given node. It should be possible to</span>
00443 <span class="comment">            use a bool (or some other mechanism) to toggle this form of search</span>
00444 <span class="comment">            (if the skip graph is small, it might be faster to just use a brute</span>
00445 <span class="comment">            force for loop to search through)</span>
00446 <span class="comment">        */</span>
00447         <span class="keywordflow">for</span>(i = 0; i &lt; i32HashTableSize; i++)
00448         {
00449             <span class="keywordflow">if</span>(m_aHashTable[i].GetHash() == Hash)
00450             {
00451                 <span class="keywordflow">return</span> &amp;m_aHashTable[i].GetNode();
00452             }
00453         }
00454 
00455         <span class="comment">/*</span>
00456 <span class="comment">            The element wasn't found, so return null</span>
00457 <span class="comment">        */</span>
00458         <span class="keywordflow">return</span> NULL;
00459     }
00460 
00461     <span class="comment">/*!***************************************************************************</span>
00462 <span class="comment">     @Function          FindNode</span>
00463 <span class="comment">     @Input/Output      data                            Data to use as a source for the hash</span>
00464 <span class="comment">     @Return            CPVRTSkipGraphNode&lt;T&gt;* const    A handle to the found node</span>
00465 <span class="comment">     @Description       Use the input data to generate a hash and then</span>
00466 <span class="comment">                        search the hash table and see if the node already exists.</span>
00467 <span class="comment">                        If it does, the function returns a pointer</span>
00468 <span class="comment">                        to the node. If it doesn't, it returns NULL</span>
00469 <span class="comment">    *****************************************************************************/</span>
00470     <a class="code" href="classCPVRTSkipGraphNode.html">CPVRTSkipGraphNode&lt;T&gt;</a>* FindNode(<span class="keyword">const</span> T&amp; data)
00471     {
00472         <a class="code" href="classCPVRTHash.html">CPVRTHash</a> inputHash((<span class="keywordtype">void</span>*)&amp;data, <span class="keyword">sizeof</span>(T), 1);    <span class="comment">// Generate hash for searching</span>
00473         <span class="keywordflow">return</span> FindNode(inputHash);
00474     }
00475 };
00476 
00477 <span class="preprocessor">#endif //__PVRTSKIPGRAPH_H__</span>
00478 <span class="preprocessor"></span>
00479 <span class="comment">/*****************************************************************************</span>
00480 <span class="comment"> End of file (PVRTSkipGraph.h)</span>
00481 <span class="comment">*****************************************************************************/</span>
00482 
00483 
</pre></div><br>
<br>
<P align=left><FONT size=2><STRONG><A 
   href="http://www.imgtec.com/powervr/insider/legal/index.asp">Copyright</A> © 
   1999-2008, Imagination Technologies Ltd.</STRONG></FONT></P>
<hr>
<address style="align: left;"><small><FONT color=f0f>
Generated by <a href="http://www.doxygen.org/index.html">DOXYGEN</a> 1.3.6</small></address>
</body>
</html>

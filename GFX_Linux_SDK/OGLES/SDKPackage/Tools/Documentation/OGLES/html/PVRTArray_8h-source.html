<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PowerVR SDK</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
<table width="100%">
  <tr>
    <td width="33%">
      <p align="left">&nbsp;<a href="http://www.imgtec.com"><img border="0" src="IMGLogo.jpg" width="200" height="30"></a></p>
    </td>
    <td width="33%">
      <p align="center"><font color="#808080" face="Arial" size="2">PowerVR Software Development Kit</a></font></p>
    </td>
    <td width="34%">
      <p align="right"><a href="http://www.powervr.com"><img border="0" src="PVRlogo.jpg" width="200" height="27"></a></p>
    </td>
  </tr>
</table>
<hr>
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>PVRTArray.h</h1><a href="PVRTArray_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/******************************************************************************</span>
00002 <span class="comment"></span>
00003 <span class="comment"> @File         PVRTArray.h</span>
00004 <span class="comment"></span>
00005 <span class="comment"> @Title        PVRTArray</span>
00006 <span class="comment"></span>
00007 <span class="comment"> @Version      </span>
00008 <span class="comment"></span>
00009 <span class="comment"> @Copyright    Copyright (c) Imagination Technologies Limited.</span>
00010 <span class="comment"></span>
00011 <span class="comment"> @Platform     ANSI compatible</span>
00012 <span class="comment"></span>
00013 <span class="comment"> @Description  Expanding array template class. Allows appending and direct</span>
00014 <span class="comment">               access. Mixing access methods should be approached with caution.</span>
00015 <span class="comment"></span>
00016 <span class="comment">******************************************************************************/</span>
00017 <span class="preprocessor">#ifndef __PVRTARRAY_H__</span>
00018 <span class="preprocessor"></span><span class="preprocessor">#define __PVRTARRAY_H__</span>
00019 <span class="preprocessor"></span>
00020 <span class="preprocessor">#include "<a class="code" href="PVRTGlobal_8h.html">PVRTGlobal.h</a>"</span>
00021 <span class="preprocessor">#include "<a class="code" href="PVRTError_8h.html">PVRTError.h</a>"</span>
00022 
00023 <span class="comment">/*!****************************************************************************</span>
00024 <span class="comment">Class</span>
00025 <span class="comment">******************************************************************************/</span>
00026 
00027 <span class="comment">/*!***************************************************************************</span>
00028 <span class="comment">* @Class CPVRTArray</span>
00029 <span class="comment">* @Brief Expanding array template class.</span>
00030 <span class="comment">* @Description Expanding array template class.</span>
00031 <span class="comment">*****************************************************************************/</span>
00032 <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;
00033 <span class="keyword">class </span><a class="code" href="classCPVRTArray.html">CPVRTArray</a>
<a name="l00034"></a><a class="code" href="classCPVRTArray.html">00034</a> {
00035 <span class="keyword">public</span>:
00036     <span class="comment">/*!***************************************************************************</span>
00037 <span class="comment">    @Function           CPVRTArray</span>
00038 <span class="comment">    @Description        Blank constructor. Makes a default sized array.</span>
00039 <span class="comment">    *****************************************************************************/</span>
00040     <a class="code" href="classCPVRTArray.html#a0">CPVRTArray</a>() : <a class="code" href="classCPVRTArray.html#p0">m_uiSize</a>(0), <a class="code" href="classCPVRTArray.html#p1">m_uiCapacity</a>(<a class="code" href="classCPVRTArray.html#e0">GetDefaultSize</a>())
00041     {
<a name="l00042"></a><a class="code" href="classCPVRTArray.html#a0">00042</a>         m_pArray = <span class="keyword">new</span> T[m_uiCapacity];
00043     }
00044 
00045     <span class="comment">/*!***************************************************************************</span>
00046 <span class="comment">    @Function           CPVRTArray</span>
00047 <span class="comment">    @Input              uiSize  intial size of array</span>
00048 <span class="comment">    @Description        Constructor taking initial size of array in elements.</span>
00049 <span class="comment">    *****************************************************************************/</span>
00050     <a class="code" href="classCPVRTArray.html#a0">CPVRTArray</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> uiSize) : m_uiSize(0), m_uiCapacity(uiSize)
00051     {
00052         <a class="code" href="PVRTGlobal_8h.html#a10">_ASSERT</a>(uiSize != 0);
<a name="l00053"></a><a class="code" href="classCPVRTArray.html#a1">00053</a>         m_pArray = <span class="keyword">new</span> T[uiSize];
00054     }
00055 
00056     <span class="comment">/*!***************************************************************************</span>
00057 <span class="comment">    @Function           CPVRTArray</span>
00058 <span class="comment">    @Input              original    the other dynamic array</span>
00059 <span class="comment">    @Description        Copy constructor.</span>
00060 <span class="comment">    *****************************************************************************/</span>
00061     <a class="code" href="classCPVRTArray.html#a0">CPVRTArray</a>(<span class="keyword">const</span> <a class="code" href="classCPVRTArray.html">CPVRTArray</a>&amp; original) : m_uiSize(original.m_uiSize),
00062                                               m_uiCapacity(original.m_uiCapacity)
00063     {
00064         m_pArray = <span class="keyword">new</span> T[m_uiCapacity];
<a name="l00065"></a><a class="code" href="classCPVRTArray.html#a2">00065</a>         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;m_uiSize;i++)
00066         {
00067             m_pArray[i]=original.<a class="code" href="classCPVRTArray.html#p2">m_pArray</a>[i];
00068         }
00069     }
00070 
00071     <span class="comment">/*!***************************************************************************</span>
00072 <span class="comment">    @Function           CPVRTArray</span>
00073 <span class="comment">    @Input              pArray      an ordinary array</span>
00074 <span class="comment">    @Input              uiSize      number of elements passed</span>
00075 <span class="comment">    @Description        constructor from ordinary array.</span>
00076 <span class="comment">    *****************************************************************************/</span>
00077     <a class="code" href="classCPVRTArray.html#a0">CPVRTArray</a>(<span class="keyword">const</span> T* <span class="keyword">const</span> pArray, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> uiSize) : <a class="code" href="classCPVRTArray.html#p0">m_uiSize</a>(uiSize),
00078                                                           <a class="code" href="classCPVRTArray.html#p1">m_uiCapacity</a>(uiSize)
00079     {
00080         <a class="code" href="PVRTGlobal_8h.html#a10">_ASSERT</a>(uiSize != 0);
00081         <a class="code" href="classCPVRTArray.html#p2">m_pArray</a> = <span class="keyword">new</span> T[uiSize];
<a name="l00082"></a><a class="code" href="classCPVRTArray.html#a3">00082</a>         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;m_uiSize;i++)
00083         {
00084             m_pArray[i]=pArray[i];
00085         }
00086     }
00087 
00088     <span class="comment">/*!***************************************************************************</span>
00089 <span class="comment">    @Function           CPVRTArray</span>
00090 <span class="comment">    @Input              uiSize      initial capacity</span>
00091 <span class="comment">    @Input              val         value to populate with</span>
00092 <span class="comment">    @Description        constructor from a capacity and initial value.</span>
00093 <span class="comment">    *****************************************************************************/</span>
00094     <a class="code" href="classCPVRTArray.html#a0">CPVRTArray</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> uiSize, <span class="keyword">const</span> T&amp; val) : <a class="code" href="classCPVRTArray.html#p0">m_uiSize</a>(uiSize),
00095                                                         <a class="code" href="classCPVRTArray.html#p1">m_uiCapacity</a>(uiSize)
00096     {
00097         <a class="code" href="PVRTGlobal_8h.html#a10">_ASSERT</a>(uiSize != 0);
00098         <a class="code" href="classCPVRTArray.html#p2">m_pArray</a> = <span class="keyword">new</span> T[uiSize];
00099         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> uiIndex = 0; uiIndex &lt; <a class="code" href="classCPVRTArray.html#p0">m_uiSize</a>; ++uiIndex)
<a name="l00100"></a><a class="code" href="classCPVRTArray.html#a4">00100</a>         {
00101             m_pArray[uiIndex] = val;
00102         }
00103     }
00104 
00105     <span class="comment">/*!***************************************************************************</span>
00106 <span class="comment">    @Function           ~CPVRTArray</span>
00107 <span class="comment">    @Description        Destructor.</span>
00108 <span class="comment">    *****************************************************************************/</span>
00109     <span class="keyword">virtual</span> <a class="code" href="classCPVRTArray.html#a5">~CPVRTArray</a>()
00110     {
00111         <span class="keywordflow">if</span>(<a class="code" href="classCPVRTArray.html#p2">m_pArray</a>)
00112             <span class="keyword">delete</span> [] <a class="code" href="classCPVRTArray.html#p2">m_pArray</a>;
00113     }
00114 
00115     <span class="comment">/*!***************************************************************************</span>
<a name="l00116"></a><a class="code" href="classCPVRTArray.html#a5">00116</a> <span class="comment">    @Function           Insert</span>
00117 <span class="comment">    @Input              pos     The position to insert the new element at</span>
00118 <span class="comment">    @Input              addT    The element to insert</span>
00119 <span class="comment">    @Return             The index of the new item or -1 on failure.</span>
00120 <span class="comment">    @Description        Inserts an element into the array, expanding it</span>
00121 <span class="comment">                        if necessary.</span>
00122 <span class="comment">    *****************************************************************************/</span>
00123     <span class="keywordtype">int</span> <a class="code" href="classCPVRTArray.html#a6">Insert</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pos, <span class="keyword">const</span> T&amp; addT)
00124     {
00125         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> uiIndex = pos;
00126 
00127         <span class="keywordflow">if</span>(pos &gt;= m_uiSize) <span class="comment">// Are we adding to the end</span>
00128             uiIndex = <a class="code" href="classCPVRTArray.html#a8">Append</a>(addT);
00129         <span class="keywordflow">else</span>
00130         {
<a name="l00131"></a><a class="code" href="classCPVRTArray.html#a6">00131</a>             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> uiNewCapacity = 0;
00132             T* pArray = m_pArray;
00133 
00134             <span class="keywordflow">if</span>(m_uiSize &gt; m_uiCapacity)
00135             {
00136                 uiNewCapacity = m_uiCapacity + 10;  <span class="comment">// Expand the array by 10.</span>
00137 
00138                 pArray = <span class="keyword">new</span> T[uiNewCapacity];      <span class="comment">// New Array</span>
00139 
00140                 <span class="keywordflow">if</span>(!pArray)
00141                     <span class="keywordflow">return</span> -1;                      <span class="comment">// Failed to allocate memory!</span>
00142 
00143                 <span class="comment">// Copy the first half to the new array</span>
00144                 <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; pos; ++i)
00145                 {
00146                     pArray[i] = m_pArray[i];
00147                 }
00148             }
00149 
00150             <span class="comment">// Copy last half to the new array</span>
00151             <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = m_uiSize; i &gt; pos; --i)
00152             {
00153                 pArray[i] = m_pArray[i - 1];
00154             }
00155 
00156             <span class="comment">// Insert our new element</span>
00157             pArray[pos] = addT;
00158             uiIndex = pos;
00159 
00160             <span class="comment">// Increase our size</span>
00161             ++m_uiSize;
00162 
00163             <span class="comment">// Switch pointers and free memory if needed</span>
00164             <span class="keywordflow">if</span>(pArray != m_pArray)
00165             {
00166                 <a class="code" href="classCPVRTArray.html#p1">m_uiCapacity</a> = uiNewCapacity;
00167                 <span class="keyword">delete</span>[] m_pArray;
00168                 m_pArray = pArray;
00169             }
00170         }
00171 
00172         <span class="keywordflow">return</span> uiIndex;
00173     }
00174 
00175     <span class="comment">/*!***************************************************************************</span>
00176 <span class="comment">    @Function           Append</span>
00177 <span class="comment">    @Input              addT    The element to append</span>
00178 <span class="comment">    @Return             The index of the new item.</span>
00179 <span class="comment">    @Description        Appends an element to the end of the array, expanding it</span>
00180 <span class="comment">                        if necessary.</span>
00181 <span class="comment">    *****************************************************************************/</span>
00182     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classCPVRTArray.html#a8">Append</a>(<span class="keyword">const</span> T&amp; addT)
00183     {
00184         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> uiIndex = <a class="code" href="classCPVRTArray.html#a8">Append</a>();
00185         <a class="code" href="classCPVRTArray.html#p2">m_pArray</a>[uiIndex] = addT;
00186         <span class="keywordflow">return</span> uiIndex;
00187     }
00188 
00189     <span class="comment">/*!***************************************************************************</span>
00190 <span class="comment">    @Function           Append</span>
<a name="l00191"></a><a class="code" href="classCPVRTArray.html#a7">00191</a> <span class="comment">    @Return             The index of the new item.</span>
00192 <span class="comment">    @Description        Creates space for a new item, but doesn't add. Instead</span>
00193 <span class="comment">                        returns the index of the new item.</span>
00194 <span class="comment">    *****************************************************************************/</span>
00195     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classCPVRTArray.html#a8">Append</a>()
00196     {
00197         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> uiIndex = m_uiSize;
00198         <a class="code" href="classCPVRTArray.html#a11">SetCapacity</a>(m_uiSize+1);
00199         m_uiSize++;
00200 
00201         <span class="keywordflow">return</span> uiIndex;
00202     }
00203 
00204     <span class="comment">/*!***************************************************************************</span>
<a name="l00205"></a><a class="code" href="classCPVRTArray.html#a8">00205</a> <span class="comment">    @Function       Clear</span>
00206 <span class="comment">    @Description    Clears the array.</span>
00207 <span class="comment">    *****************************************************************************/</span>
00208     <span class="keywordtype">void</span> <a class="code" href="classCPVRTArray.html#a9">Clear</a>()
00209     {
00210         m_uiSize = 0U;
00211     }
00212 
00213     <span class="comment">/*!***************************************************************************</span>
00214 <span class="comment">    @Function           Resize</span>
00215 <span class="comment">    @Input              uiSize      New size of array</span>
00216 <span class="comment">    @Description        Changes the array to the new size</span>
00217 <span class="comment">    *****************************************************************************/</span>
00218     <a class="code" href="PVRTError_8h.html#a5">EPVRTError</a> <a class="code" href="classCPVRTArray.html#a10">Resize</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> uiSize)
<a name="l00219"></a><a class="code" href="classCPVRTArray.html#a9">00219</a>     {
00220         <a class="code" href="PVRTError_8h.html#a5">EPVRTError</a> err = <a class="code" href="classCPVRTArray.html#a11">SetCapacity</a>(uiSize);
00221 
00222         <span class="keywordflow">if</span>(err != <a class="code" href="PVRTError_8h.html#a5a1">PVR_SUCCESS</a>)
00223             <span class="keywordflow">return</span> err;
00224 
00225         m_uiSize = uiSize;
00226         <span class="keywordflow">return</span> <a class="code" href="PVRTError_8h.html#a5a1">PVR_SUCCESS</a>;
00227     }
00228 
00229     <span class="comment">/*!***************************************************************************</span>
<a name="l00230"></a><a class="code" href="classCPVRTArray.html#a10">00230</a> <span class="comment">    @Function           SetCapacity</span>
00231 <span class="comment">    @Input              uiSize      New capacity of array</span>
00232 <span class="comment">    @Description        Expands array to new capacity</span>
00233 <span class="comment">    *****************************************************************************/</span>
00234     <a class="code" href="PVRTError_8h.html#a5">EPVRTError</a> <a class="code" href="classCPVRTArray.html#a11">SetCapacity</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> uiSize)
00235     {
00236         <span class="keywordflow">if</span>(uiSize &lt;= m_uiCapacity)
00237             <span class="keywordflow">return</span> <a class="code" href="PVRTError_8h.html#a5a1">PVR_SUCCESS</a>; <span class="comment">// nothing to be done</span>
00238 
00239         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> uiNewCapacity;
00240         <span class="keywordflow">if</span>(uiSize &lt; m_uiCapacity*2)
00241         {
00242             uiNewCapacity = m_uiCapacity*2;         <span class="comment">// Ignore the new size. Expand to twice the previous size.</span>
00243         }
00244         <span class="keywordflow">else</span>
00245         {
00246             uiNewCapacity = uiSize;
<a name="l00247"></a><a class="code" href="classCPVRTArray.html#a11">00247</a>         }
00248 
00249         T* pNewArray = <span class="keyword">new</span> T[uiNewCapacity];        <span class="comment">// New Array</span>
00250         <span class="keywordflow">if</span>(!pNewArray)
00251             <span class="keywordflow">return</span> <a class="code" href="PVRTError_8h.html#a5a2">PVR_FAIL</a>;                        <span class="comment">// Failed to allocate memory!</span>
00252 
00253         <span class="comment">// Copy source data to new array</span>
00254         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; m_uiSize; ++i)
00255         {
00256             pNewArray[i] = m_pArray[i];
00257         }
00258 
00259         <span class="comment">// Switch pointers and free memory</span>
00260         <a class="code" href="classCPVRTArray.html#p1">m_uiCapacity</a>    = uiNewCapacity;
00261         T* pOldArray    = <a class="code" href="classCPVRTArray.html#p2">m_pArray</a>;
00262         m_pArray        = pNewArray;
00263         <span class="keyword">delete</span> [] pOldArray;
00264         <span class="keywordflow">return</span> <a class="code" href="PVRTError_8h.html#a5a1">PVR_SUCCESS</a>;
00265     }
00266 
00267     <span class="comment">/*!***************************************************************************</span>
00268 <span class="comment">    @Function           Copy</span>
00269 <span class="comment">    @Input              other   The CPVRTArray needing copied</span>
00270 <span class="comment">    @Description        A copy function. Will attempt to copy from other CPVRTArrays</span>
00271 <span class="comment">                        if this is possible.</span>
00272 <span class="comment">    *****************************************************************************/</span>
00273     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T2&gt;
00274     <span class="keywordtype">void</span> <a class="code" href="classCPVRTArray.html#a12">Copy</a>(<span class="keyword">const</span> <a class="code" href="classCPVRTArray.html">CPVRTArray&lt;T2&gt;</a>&amp; other)
00275     {
00276         T* pNewArray = <span class="keyword">new</span> T[other.<a class="code" href="classCPVRTArray.html#a18">GetCapacity</a>()];
00277         <span class="keywordflow">if</span>(pNewArray)
00278         {
00279             <span class="comment">// Copy data</span>
00280             <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; other.<a class="code" href="classCPVRTArray.html#a17">GetSize</a>(); i++)
00281             {
00282                 pNewArray[i] = other[i];
00283             }
00284 
00285             <span class="comment">// Free current array</span>
00286             <span class="keywordflow">if</span>(<a class="code" href="classCPVRTArray.html#p2">m_pArray</a>)
00287                 <span class="keyword">delete</span> [] <a class="code" href="classCPVRTArray.html#p2">m_pArray</a>;
<a name="l00288"></a><a class="code" href="classCPVRTArray.html#a12">00288</a> 
00289             <span class="comment">// Swap pointers</span>
00290             m_pArray        = pNewArray;
00291 
00292             m_uiCapacity    = other.<a class="code" href="classCPVRTArray.html#a18">GetCapacity</a>();
00293             m_uiSize        = other.<a class="code" href="classCPVRTArray.html#a17">GetSize</a>();
00294         }
00295     }
00296 
00297     <span class="comment">/*!***************************************************************************</span>
00298 <span class="comment">    @Function           =</span>
00299 <span class="comment">    @Input              other   The CPVRTArray needing copied</span>
00300 <span class="comment">    @Description        assignment operator.</span>
00301 <span class="comment">    *****************************************************************************/</span>
00302     <a class="code" href="classCPVRTArray.html">CPVRTArray</a>&amp; <a class="code" href="classCPVRTArray.html#a13">operator=</a>(<span class="keyword">const</span> <a class="code" href="classCPVRTArray.html">CPVRTArray&lt;T&gt;</a>&amp; other)
00303     {
00304         <span class="keywordflow">if</span>(&amp;other != <span class="keyword">this</span>)
00305             <a class="code" href="classCPVRTArray.html#a12">Copy</a>(other);
00306 
00307         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00308     }
00309 
00310     <span class="comment">/*!***************************************************************************</span>
00311 <span class="comment">    @Function       operator+=</span>
00312 <span class="comment">    @Input          other       the array to append.</span>
00313 <span class="comment">    @Description    appends an existing CPVRTArray on to this one.</span>
00314 <span class="comment">    *****************************************************************************/</span>
00315     <a class="code" href="classCPVRTArray.html">CPVRTArray</a>&amp; <a class="code" href="classCPVRTArray.html#a14">operator+=</a>(<span class="keyword">const</span> <a class="code" href="classCPVRTArray.html">CPVRTArray&lt;T&gt;</a>&amp; other)
00316     {
<a name="l00317"></a><a class="code" href="classCPVRTArray.html#a13">00317</a>         <span class="keywordflow">if</span>(&amp;other != <span class="keyword">this</span>)
00318         {
00319             <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> uiIndex = 0; uiIndex &lt; other.<a class="code" href="classCPVRTArray.html#a17">GetSize</a>(); ++uiIndex)
00320             {
00321                 <a class="code" href="classCPVRTArray.html#a8">Append</a>(other[uiIndex]);
00322             }
00323         }
00324 
00325         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00326     }
00327 
00328     <span class="comment">/*!***************************************************************************</span>
00329 <span class="comment">    @Function           []</span>
00330 <span class="comment">    @Input              uiIndex index of element in array</span>
<a name="l00331"></a><a class="code" href="classCPVRTArray.html#a14">00331</a> <span class="comment">    @Return             the element indexed</span>
00332 <span class="comment">    @Description        indexed access into array. Note that this has no error</span>
00333 <span class="comment">                        checking whatsoever</span>
00334 <span class="comment">    *****************************************************************************/</span>
00335     T&amp; <a class="code" href="classCPVRTArray.html#a15">operator[]</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> uiIndex)
00336     {
00337         <a class="code" href="PVRTGlobal_8h.html#a10">_ASSERT</a>(uiIndex &lt; m_uiCapacity);
00338         <span class="keywordflow">return</span> m_pArray[uiIndex];
00339     }
00340 
00341     <span class="comment">/*!***************************************************************************</span>
00342 <span class="comment">    @Function           []</span>
00343 <span class="comment">    @Input              uiIndex index of element in array</span>
00344 <span class="comment">    @Return             The element indexed</span>
00345 <span class="comment">    @Description        Indexed access into array. Note that this has no error</span>
00346 <span class="comment">                        checking whatsoever</span>
00347 <span class="comment">    *****************************************************************************/</span>
00348     <span class="keyword">const</span> T&amp; <a class="code" href="classCPVRTArray.html#a15">operator[]</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> uiIndex)<span class="keyword"> const</span>
00349 <span class="keyword">    </span>{
00350         <a class="code" href="PVRTGlobal_8h.html#a10">_ASSERT</a>(uiIndex &lt; m_uiCapacity);
00351         <span class="keywordflow">return</span> m_pArray[uiIndex];
<a name="l00352"></a><a class="code" href="classCPVRTArray.html#a15">00352</a>     }
00353 
00354     <span class="comment">/*!***************************************************************************</span>
00355 <span class="comment">    @Function           GetSize</span>
00356 <span class="comment">    @Return             Size of array</span>
00357 <span class="comment">    @Description        Gives current size of array/number of elements</span>
00358 <span class="comment">    *****************************************************************************/</span>
00359     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classCPVRTArray.html#a17">GetSize</a>()<span class="keyword"> const</span>
00360 <span class="keyword">    </span>{
00361         <span class="keywordflow">return</span> m_uiSize;
00362     }
00363 
00364     <span class="comment">/*!***************************************************************************</span>
00365 <span class="comment">    @Function           GetDefaultSize</span>
<a name="l00366"></a><a class="code" href="classCPVRTArray.html#a16">00366</a> <span class="comment">    @Return             Default size of array</span>
00367 <span class="comment">    @Description        Gives the default size of array/number of elements</span>
00368 <span class="comment">    *****************************************************************************/</span>
00369     <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classCPVRTArray.html#e0">GetDefaultSize</a>()
00370     {
00371         <span class="keywordflow">return</span> 16U;
00372     }
00373 
00374     <span class="comment">/*!***************************************************************************</span>
00375 <span class="comment">    @Function           GetCapacity</span>
00376 <span class="comment">    @Return             Capacity of array</span>
00377 <span class="comment">    @Description        Gives current allocated size of array/number of elements</span>
<a name="l00378"></a><a class="code" href="classCPVRTArray.html#a17">00378</a> <span class="comment">    *****************************************************************************/</span>
00379     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classCPVRTArray.html#a18">GetCapacity</a>()<span class="keyword"> const</span>
00380 <span class="keyword">    </span>{
00381         <span class="keywordflow">return</span> m_uiCapacity;
00382     }
00383 
00384     <span class="comment">/*!***************************************************************************</span>
00385 <span class="comment">    @Function           Contains</span>
00386 <span class="comment">    @Input              object      The object to check in the array</span>
00387 <span class="comment">    @Return             true if object is contained in this array.</span>
00388 <span class="comment">    @Description        Indicates whether the given object resides inside the </span>
<a name="l00389"></a><a class="code" href="classCPVRTArray.html#e0">00389</a> <span class="comment">                        array.</span>
00390 <span class="comment">    *****************************************************************************/</span>
00391     <span class="keywordtype">bool</span> <a class="code" href="classCPVRTArray.html#a19">Contains</a>(<span class="keyword">const</span> T&amp; object)<span class="keyword"> const</span>
00392 <span class="keyword">    </span>{
00393         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> uiIndex = 0; uiIndex &lt; m_uiSize; ++uiIndex)
00394         {
00395             <span class="keywordflow">if</span>(m_pArray[uiIndex] == object)
00396                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
00397         }
00398         <span class="keywordflow">return</span> <span class="keyword">false</span>;
00399     }
<a name="l00400"></a><a class="code" href="classCPVRTArray.html#a18">00400</a> 
00401     <span class="comment">/*!***************************************************************************</span>
00402 <span class="comment">    @Function           Find</span>
00403 <span class="comment">    @Input              object      The object to check in the array</span>
00404 <span class="comment">    @Return             pointer to the found object or NULL.</span>
00405 <span class="comment">    @Description        Attempts to find the object in the array and returns a</span>
00406 <span class="comment">                        pointer if it is found, or NULL if not found. The time</span>
00407 <span class="comment">                        taken is O(N).</span>
00408 <span class="comment">    *****************************************************************************/</span>
00409     T* <a class="code" href="classCPVRTArray.html#a20">Find</a>(<span class="keyword">const</span> T&amp; object)<span class="keyword"> const</span>
00410 <span class="keyword">    </span>{
00411         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> uiIndex = 0; uiIndex &lt; m_uiSize; ++uiIndex)
00412         {
<a name="l00413"></a><a class="code" href="classCPVRTArray.html#a19">00413</a>             <span class="keywordflow">if</span>(m_pArray[uiIndex] == object)
00414                 <span class="keywordflow">return</span> &amp;m_pArray[uiIndex];
00415         }
00416         <span class="keywordflow">return</span> NULL;
00417     }
00418 
00419     <span class="comment">/*!***************************************************************************</span>
00420 <span class="comment">    @Function           Sort</span>
00421 <span class="comment">    @Input              predicate       The object which defines "bool operator()"</span>
00422 <span class="comment">    @Description        Simple bubble-sort of the array. Pred should be an object that</span>
00423 <span class="comment">                        defines a bool operator().</span>
00424 <span class="comment">    *****************************************************************************/</span>
00425     <span class="keyword">template</span>&lt;<span class="keyword">class</span> Pred&gt;
00426     <span class="keywordtype">void</span> <a class="code" href="classCPVRTArray.html#a21">Sort</a>(Pred predicate)
00427     {
00428         <span class="keywordtype">bool</span> bSwap;
00429         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; <a class="code" href="classCPVRTArray.html#p0">m_uiSize</a>; ++i)
00430         {
00431             bSwap = <span class="keyword">false</span>;
<a name="l00432"></a><a class="code" href="classCPVRTArray.html#a20">00432</a>             <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j &lt; m_uiSize-1; ++j)
00433             {
00434                 <span class="keywordflow">if</span>(predicate(m_pArray[j], m_pArray[j+1]))
00435                 {
00436                     <a class="code" href="PVRTGlobal_8h.html#a46">PVRTswap</a>(m_pArray[j], m_pArray[j+1]);
00437                     bSwap = <span class="keyword">true</span>;
00438                 }
00439             }
00440 
00441             <span class="keywordflow">if</span>(!bSwap)
00442                 <span class="keywordflow">return</span>;
00443         }
00444     }
00445 
00446     <span class="comment">/*!***************************************************************************</span>
00447 <span class="comment">    @Function       Remove</span>
00448 <span class="comment">    @Input          uiIndex     The index to remove</span>
00449 <span class="comment">    @Return         success or failure</span>
<a name="l00450"></a><a class="code" href="classCPVRTArray.html#a21">00450</a> <span class="comment">    @Description    Removes an element from the array.</span>
00451 <span class="comment">    *****************************************************************************/</span>
00452     <span class="keyword">virtual</span> <a class="code" href="PVRTError_8h.html#a5">EPVRTError</a> <a class="code" href="classCPVRTArray.html#a22">Remove</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> uiIndex)
00453     {
00454         <a class="code" href="PVRTGlobal_8h.html#a10">_ASSERT</a>(uiIndex &lt; m_uiSize);
00455         <span class="keywordflow">if</span>(m_uiSize == 0)
00456             <span class="keywordflow">return</span> <a class="code" href="PVRTError_8h.html#a5a2">PVR_FAIL</a>;
00457 
00458         <span class="keywordflow">if</span>(uiIndex == m_uiSize-1)
00459         {
00460             <span class="keywordflow">return</span> <a class="code" href="classCPVRTArray.html#a23">RemoveLast</a>();
00461         }
00462         
00463         m_uiSize--;
00464         <span class="comment">// Copy the data. memmove will only work for built-in types.</span>
00465         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> uiNewIdx = uiIndex; uiNewIdx &lt; m_uiSize; ++uiNewIdx)
00466         {
00467             m_pArray[uiNewIdx] = m_pArray[uiNewIdx+1];
00468         }
00469         
00470         <span class="keywordflow">return</span> <a class="code" href="PVRTError_8h.html#a5a1">PVR_SUCCESS</a>;
00471     }
00472 
00473     <span class="comment">/*!***************************************************************************</span>
00474 <span class="comment">    @Function           RemoveLast</span>
00475 <span class="comment">    @Return             success or failure</span>
00476 <span class="comment">    @Description        Removes the last element. Simply decrements the size value</span>
<a name="l00477"></a><a class="code" href="classCPVRTArray.html#a22">00477</a> <span class="comment">    *****************************************************************************/</span>
00478     <span class="keyword">virtual</span> <a class="code" href="PVRTError_8h.html#a5">EPVRTError</a> <a class="code" href="classCPVRTArray.html#a23">RemoveLast</a>()
00479     {
00480         <span class="keywordflow">if</span>(m_uiSize &gt; 0)
00481         {
00482             m_uiSize--;
00483             <span class="keywordflow">return</span> <a class="code" href="PVRTError_8h.html#a5a1">PVR_SUCCESS</a>;
00484         }   
00485         <span class="keywordflow">else</span>
00486         {
00487             <span class="keywordflow">return</span> <a class="code" href="PVRTError_8h.html#a5a2">PVR_FAIL</a>;
00488         }
00489     }
00490 
00491 <span class="keyword">protected</span>:
00492     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>    m_uiSize;               
00493     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>    m_uiCapacity;           
00494     T               *m_pArray;              
00495 };
00496 
00497 <span class="comment">// note "this" is required for ISO standard C++ and gcc complains otherwise</span>
00498 <span class="comment">// http://lists.apple.com/archives/Xcode-users//2005/Dec/msg00644.html</span>
00499 <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;
00500 <span class="keyword">class </span><a class="code" href="classCPVRTArrayManagedPointers.html">CPVRTArrayManagedPointers</a> : <span class="keyword">public</span> <a class="code" href="classCPVRTArray.html">CPVRTArray</a>&lt;T*&gt;
00501 {
00502 <span class="keyword">public</span>:
00503     <span class="keyword">virtual</span> <a class="code" href="classCPVRTArrayManagedPointers.html#a0">~CPVRTArrayManagedPointers</a>()
<a name="l00504"></a><a class="code" href="classCPVRTArray.html#a23">00504</a>     {
00505         <span class="keywordflow">if</span>(this-&gt;m_pArray)
00506         {
00507             <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;this-&gt;m_uiSize;i++)
00508             {
00509                 <span class="keyword">delete</span>(this-&gt;m_pArray[i]);
00510             }
00511         }
00512     }
00513 
00514     <span class="comment">/*!***************************************************************************</span>
00515 <span class="comment">    @Function       Remove</span>
00516 <span class="comment">    @Input          uiIndex     The index to remove</span>
00517 <span class="comment">    @Return         success or failure</span>
<a name="l00518"></a><a class="code" href="classCPVRTArray.html#p0">00518</a> <span class="comment">    @Description    Removes an element from the array.</span>
<a name="l00519"></a><a class="code" href="classCPVRTArray.html#p1">00519</a> <span class="comment">    *****************************************************************************/</span>
<a name="l00520"></a><a class="code" href="classCPVRTArray.html#p2">00520</a>     <span class="keyword">virtual</span> <a class="code" href="PVRTError_8h.html#a5">EPVRTError</a> <a class="code" href="classCPVRTArrayManagedPointers.html#a1">Remove</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> uiIndex)
00521     {
00522         <a class="code" href="PVRTGlobal_8h.html#a10">_ASSERT</a>(uiIndex &lt; this-&gt;m_uiSize);
00523         <span class="keywordflow">if</span>(this-&gt;m_uiSize == 0)
00524             <span class="keywordflow">return</span> <a class="code" href="PVRTError_8h.html#a5a2">PVR_FAIL</a>;
00525 
<a name="l00526"></a><a class="code" href="classCPVRTArrayManagedPointers.html">00526</a>         <span class="keywordflow">if</span>(uiIndex == this-&gt;m_uiSize-1)
00527         {
00528             <span class="keywordflow">return</span> this-&gt;<a class="code" href="classCPVRTArrayManagedPointers.html#a2">RemoveLast</a>();
<a name="l00529"></a><a class="code" href="classCPVRTArrayManagedPointers.html#a0">00529</a>         }
00530 
00531         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> uiSize = (this-&gt;m_uiSize - (uiIndex+1)) * <span class="keyword">sizeof</span>(T*);
00532     
00533         <span class="keyword">delete</span> this-&gt;m_pArray[uiIndex];
00534         memmove(this-&gt;m_pArray + uiIndex, this-&gt;m_pArray + (uiIndex+1), uiSize);
00535 
00536         this-&gt;m_uiSize--;
00537         <span class="keywordflow">return</span> <a class="code" href="PVRTError_8h.html#a5a1">PVR_SUCCESS</a>;
00538     }
00539 
00540     <span class="comment">/*!***************************************************************************</span>
00541 <span class="comment">    @Function           RemoveLast</span>
00542 <span class="comment">    @Return             success or failure</span>
00543 <span class="comment">    @Description        Removes the last element. Simply decrements the size value</span>
00544 <span class="comment">    *****************************************************************************/</span>
00545     <span class="keyword">virtual</span> <a class="code" href="PVRTError_8h.html#a5">EPVRTError</a> <a class="code" href="classCPVRTArrayManagedPointers.html#a2">RemoveLast</a>()
00546     {
<a name="l00547"></a><a class="code" href="classCPVRTArrayManagedPointers.html#a1">00547</a>         <span class="keywordflow">if</span>(this-&gt;m_uiSize &gt; 0 &amp;&amp; this-&gt;m_pArray)
00548         {
00549             <span class="keyword">delete</span> this-&gt;m_pArray[this-&gt;m_uiSize-1];
00550             this-&gt;m_uiSize--;
00551             <span class="keywordflow">return</span> <a class="code" href="PVRTError_8h.html#a5a1">PVR_SUCCESS</a>;
00552         }
00553         <span class="keywordflow">else</span>
00554         {
00555             <span class="keywordflow">return</span> <a class="code" href="PVRTError_8h.html#a5a2">PVR_FAIL</a>;
00556         }
00557     }
00558 };
00559 
00560 <span class="preprocessor">#endif // __PVRTARRAY_H__</span>
00561 <span class="preprocessor"></span>
00562 <span class="comment">/*****************************************************************************</span>
00563 <span class="comment">End of file (PVRTArray.h)</span>
00564 <span class="comment">*****************************************************************************/</span>
00565 
</pre></div><br>
<br>
<P align=left><FONT size=2><STRONG><A 
   href="http://www.imgtec.com/powervr/insider/legal/index.asp">Copyright</A> © 
   1999-2008, Imagination Technologies Ltd.</STRONG></FONT></P>
<hr>
<address style="align: left;"><small><FONT color=f0f>
Generated by <a href="http://www.doxygen.org/index.html">DOXYGEN</a> 1.3.6</small></address>
</body>
</html>
